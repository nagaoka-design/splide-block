(()=>{"use strict";var e={n:l=>{var a=l&&l.__esModule?()=>l.default:()=>l;return e.d(a,{a}),a},d:(l,a)=>{for(var t in a)e.o(a,t)&&!e.o(l,t)&&Object.defineProperty(l,t,{enumerable:!0,get:a[t]})},o:(e,l)=>Object.prototype.hasOwnProperty.call(e,l)};const l=window.wp.blocks,a=window.wp.blockEditor,t=window.wp.components,i=window.wp.i18n,o=window.wp.element,n=window.wp.apiFetch;var s=e.n(n);const d=window.ReactJSXRuntime;(0,l.registerBlockType)("custom/splide-block",{title:(0,i.__)("Splideスライドショー","splide-block"),icon:"images-alt2",category:"media",attributes:{images:{type:"array",default:[]},autoplay:{type:"boolean",default:!0},interval:{type:"number",default:3e3},type:{type:"string",default:"loop"},perPage:{type:"number",default:1},mediaQuery:{type:"string",default:"max"},perPageTablet:{type:"number",default:2},perPageMobile:{type:"number",default:1},breakpointTablet:{type:"number",default:768},breakpointMobile:{type:"number",default:480},height:{type:"string",default:""},heightRatio:{type:"number",default:0},heightRatioTablet:{type:"number",default:0},heightRatioMobile:{type:"number",default:0},fixedWidth:{type:"string",default:""},fixedHeight:{type:"string",default:""},fixedWidthTablet:{type:"string",default:""},fixedHeightTablet:{type:"string",default:""},fixedWidthMobile:{type:"string",default:""},fixedHeightMobile:{type:"string",default:""},gap:{type:"string",default:"1rem"},padding:{type:"string",default:"0"},arrows:{type:"boolean",default:!0},pagination:{type:"boolean",default:!0},speed:{type:"number",default:400},rewind:{type:"boolean",default:!1},drag:{type:"boolean",default:!0},keyboard:{type:"boolean",default:!1},objectFit:{type:"string",default:"cover"},cssMode:{type:"string",default:"standard"}},edit:e=>{const{attributes:l,setAttributes:n}=e,{images:p,autoplay:r,interval:h,type:b,perPage:g,mediaQuery:c,perPageTablet:x,perPageMobile:u,breakpointTablet:_,breakpointMobile:m,height:k,heightRatio:C,heightRatioTablet:j,heightRatioMobile:v,fixedWidth:f,fixedHeight:y,fixedWidthTablet:T,fixedHeightTablet:R,fixedWidthMobile:w,fixedHeightMobile:M,gap:P,padding:S,arrows:H,pagination:W,speed:B,rewind:O,drag:N,keyboard:F,objectFit:E,cssMode:D}=l,[Q,$]=(0,o.useState)({}),[J,U]=(0,o.useState)(""),[q,A]=(0,o.useState)(""),[I,L]=(0,o.useState)(""),[X,z]=(0,o.useState)("success");return(0,o.useEffect)(()=>{s()({path:"/splide-block/v1/presets"}).then(e=>{$(e)}).catch(e=>{console.error("プリセット取得エラー:",e)})},[]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(a.InspectorControls,{children:[(0,d.jsxs)(t.PanelBody,{title:(0,i.__)("プリセット設定","splide-block"),initialOpen:!0,children:[I&&(0,d.jsx)(t.Notice,{status:X,isDismissible:!1,children:I}),(0,d.jsx)(t.SelectControl,{label:(0,i.__)("保存済みプリセット","splide-block"),value:J,options:[{label:"選択してください",value:""},...Object.keys(Q).map(e=>({label:Q[e].name,value:e}))],onChange:e=>U(e)}),(0,d.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[(0,d.jsx)(t.Button,{variant:"secondary",onClick:()=>{if(!J||!Q[J])return L("プリセットを選択してください"),void z("error");const e=Q[J];n(e.settings),L(`「${e.name}」を読み込みました`),z("success"),setTimeout(()=>L(""),3e3)},disabled:!J,children:(0,i.__)("読み込み","splide-block")}),(0,d.jsx)(t.Button,{variant:"secondary",onClick:()=>{if(!J||!Q[J])return L("プリセットを選択してください"),void z("error");confirm(`「${Q[J].name}」を削除しますか？`)&&s()({path:`/splide-block/v1/presets/${J}`,method:"DELETE"}).then(e=>(L(e.message),z("success"),U(""),s()({path:"/splide-block/v1/presets"}))).then(e=>{$(e),setTimeout(()=>L(""),3e3)}).catch(e=>{L("削除に失敗しました"),z("error"),console.error("プリセット削除エラー:",e)})},disabled:!J,isDestructive:!0,children:(0,i.__)("削除","splide-block")})]}),(0,d.jsx)("hr",{style:{margin:"16px 0"}}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("新規プリセット名","splide-block"),value:q,onChange:e=>A(e),placeholder:"例: 16:9スライドショー"}),(0,d.jsx)(t.Button,{variant:"primary",onClick:()=>{if(!q.trim())return L("プリセット名を入力してください"),void z("error");const{images:e,...a}=l;s()({path:"/splide-block/v1/presets",method:"POST",data:{name:q,settings:a}}).then(e=>(L(e.message),z("success"),A(""),s()({path:"/splide-block/v1/presets"}))).then(e=>{$(e),setTimeout(()=>L(""),3e3)}).catch(e=>{L("保存に失敗しました"),z("error"),console.error("プリセット保存エラー:",e)})},disabled:!q.trim(),children:(0,i.__)("現在の設定を保存","splide-block")})]}),(0,d.jsxs)(t.PanelBody,{title:(0,i.__)("基本設定","splide-block"),initialOpen:!1,children:[(0,d.jsx)(t.SelectControl,{label:(0,i.__)("タイプ","splide-block"),value:b,options:[{label:"ループ",value:"loop"},{label:"スライド",value:"slide"},{label:"フェード",value:"fade"}],onChange:e=>n({type:e})}),(0,d.jsx)(t.ToggleControl,{label:(0,i.__)("自動再生","splide-block"),checked:r,onChange:e=>n({autoplay:e})}),r&&(0,d.jsx)(t.RangeControl,{label:(0,i.__)("間隔（ミリ秒）","splide-block"),value:h,onChange:e=>n({interval:e}),min:1e3,max:1e4,step:500}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("スライド速度（ミリ秒）","splide-block"),value:B,onChange:e=>n({speed:e}),min:100,max:2e3,step:100}),(0,d.jsx)(t.SelectControl,{label:(0,i.__)("CSSの読み込み","splide-block"),value:D,options:[{label:"標準CSS（デフォルトスタイル付き）",value:"standard"},{label:"コアCSS（最小限、カスタマイズ前提）",value:"core"},{label:"なし（自分で読み込む/完全カスタム）",value:"none"}],onChange:e=>n({cssMode:e}),help:"標準CSS=splide.min.css、コアCSS=splide-core.min.css"})]}),(0,d.jsxs)(t.PanelBody,{title:(0,i.__)("レスポンシブ設定","splide-block"),initialOpen:!1,children:[(0,d.jsx)(t.RadioControl,{label:(0,i.__)("レスポンシブモード","splide-block"),selected:c,options:[{label:"デスクトップファースト（max-width）",value:"max"},{label:"モバイルファースト（min-width）",value:"min"}],onChange:e=>n({mediaQuery:e}),help:"max"===c?"デフォルト設定が最も広い画面用になります。ブレークポイントは「◯◯px以下」の意味です。":"デフォルト設定が最も狭い画面用になります。ブレークポイントは「◯◯px以上」の意味です。"}),(0,d.jsx)("hr",{style:{margin:"20px 0"}}),"max"===c?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("h3",{children:(0,i.__)("PC設定（デフォルト）","splide-block")}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("表示枚数","splide-block"),value:g,onChange:e=>n({perPage:e}),min:1,max:6}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("高さ比率（heightRatio）","splide-block"),value:C,onChange:e=>n({heightRatio:e}),min:0,max:3,step:1e-4,help:"0の場合は無効。0.5625 = 16:9, 1 = 正方形, 1.7778 = 9:16"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの幅（個別）","splide-block"),value:f,onChange:e=>n({fixedWidth:e}),help:"例: 300px"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの高さ（個別）","splide-block"),value:y,onChange:e=>n({fixedHeight:e}),help:"例: 200px"}),(0,d.jsx)("hr",{style:{margin:"20px 0"}}),(0,d.jsx)("h3",{children:(0,i.__)("タブレット設定","splide-block")}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("ブレークポイント（px以下）","splide-block"),value:_,onChange:e=>n({breakpointTablet:e}),min:600,max:1200,step:1}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("表示枚数","splide-block"),value:x,onChange:e=>n({perPageTablet:e}),min:1,max:5}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("高さ比率（heightRatio）","splide-block"),value:j,onChange:e=>n({heightRatioTablet:e}),min:0,max:3,step:1e-4,help:"0の場合は無効"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの幅（個別）","splide-block"),value:T,onChange:e=>n({fixedWidthTablet:e}),help:"例: 300px"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの高さ（個別）","splide-block"),value:R,onChange:e=>n({fixedHeightTablet:e}),help:"例: 200px"}),(0,d.jsx)("hr",{style:{margin:"20px 0"}}),(0,d.jsx)("h3",{children:(0,i.__)("モバイル設定","splide-block")}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("ブレークポイント（px以下）","splide-block"),value:m,onChange:e=>n({breakpointMobile:e}),min:320,max:800,step:1}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("表示枚数","splide-block"),value:u,onChange:e=>n({perPageMobile:e}),min:1,max:3}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("高さ比率（heightRatio）","splide-block"),value:v,onChange:e=>n({heightRatioMobile:e}),min:0,max:3,step:1e-4,help:"0の場合は無効"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの幅（個別）","splide-block"),value:w,onChange:e=>n({fixedWidthMobile:e}),help:"例: 300px"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの高さ（個別）","splide-block"),value:M,onChange:e=>n({fixedHeightMobile:e}),help:"例: 200px"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("h3",{children:(0,i.__)("モバイル設定（デフォルト）","splide-block")}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("表示枚数","splide-block"),value:u,onChange:e=>n({perPageMobile:e}),min:1,max:3}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("高さ比率（heightRatio）","splide-block"),value:v,onChange:e=>n({heightRatioMobile:e}),min:0,max:3,step:1e-4,help:"0の場合は無効"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの幅（個別）","splide-block"),value:w,onChange:e=>n({fixedWidthMobile:e}),help:"例: 300px"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの高さ（個別）","splide-block"),value:M,onChange:e=>n({fixedHeightMobile:e}),help:"例: 200px"}),(0,d.jsx)("hr",{style:{margin:"20px 0"}}),(0,d.jsx)("h3",{children:(0,i.__)("タブレット設定","splide-block")}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("ブレークポイント（px以上）","splide-block"),value:m,onChange:e=>n({breakpointMobile:e}),min:320,max:800,step:1}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("表示枚数","splide-block"),value:x,onChange:e=>n({perPageTablet:e}),min:1,max:5}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("高さ比率（heightRatio）","splide-block"),value:j,onChange:e=>n({heightRatioTablet:e}),min:0,max:3,step:1e-4,help:"0の場合は無効"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの幅（個別）","splide-block"),value:T,onChange:e=>n({fixedWidthTablet:e}),help:"例: 300px"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの高さ（個別）","splide-block"),value:R,onChange:e=>n({fixedHeightTablet:e}),help:"例: 200px"}),(0,d.jsx)("hr",{style:{margin:"20px 0"}}),(0,d.jsx)("h3",{children:(0,i.__)("PC設定","splide-block")}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("ブレークポイント（px以上）","splide-block"),value:_,onChange:e=>n({breakpointTablet:e}),min:600,max:1200,step:1}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("表示枚数","splide-block"),value:g,onChange:e=>n({perPage:e}),min:1,max:6}),(0,d.jsx)(t.RangeControl,{label:(0,i.__)("高さ比率（heightRatio）","splide-block"),value:C,onChange:e=>n({heightRatio:e}),min:0,max:3,step:1e-4,help:"0の場合は無効。0.5625 = 16:9, 1 = 正方形, 1.7778 = 9:16"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの幅（個別）","splide-block"),value:f,onChange:e=>n({fixedWidth:e}),help:"例: 300px"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの高さ（個別）","splide-block"),value:y,onChange:e=>n({fixedHeight:e}),help:"例: 200px"})]})]}),(0,d.jsxs)(t.PanelBody,{title:(0,i.__)("サイズ設定","splide-block"),initialOpen:!1,children:[(0,d.jsx)(t.SelectControl,{label:(0,i.__)("画像の表示方法","splide-block"),value:E,options:[{label:"カバー（切り抜き）",value:"cover"},{label:"全体表示（余白あり）",value:"contain"}],onChange:e=>n({objectFit:e})}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライダーの高さ（全体）","splide-block"),value:k,onChange:e=>n({height:e}),help:"例: 400px, 50vh。空欄の場合は画像の高さに自動調整"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの幅（個別）","splide-block"),value:f,onChange:e=>n({fixedWidth:e}),help:"例: 300px。すべてのスライドを同じ幅に固定"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライドの高さ（個別）","splide-block"),value:y,onChange:e=>n({fixedHeight:e}),help:"例: 200px。すべてのスライドを同じ高さに固定"})]}),(0,d.jsxs)(t.PanelBody,{title:(0,i.__)("スペース設定","splide-block"),initialOpen:!1,children:[(0,d.jsx)(t.TextControl,{label:(0,i.__)("スライド間の余白（gap）","splide-block"),value:P,onChange:e=>n({gap:e}),help:"例: 1rem, 20px"}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("左右の余白（padding）","splide-block"),value:S,onChange:e=>n({padding:e}),help:"例: 2rem, 5%"})]}),(0,d.jsxs)(t.PanelBody,{title:(0,i.__)("表示オプション","splide-block"),initialOpen:!1,children:[(0,d.jsx)(t.ToggleControl,{label:(0,i.__)("矢印を表示","splide-block"),checked:H,onChange:e=>n({arrows:e})}),(0,d.jsx)(t.ToggleControl,{label:(0,i.__)("ページネーションを表示","splide-block"),checked:W,onChange:e=>n({pagination:e})}),(0,d.jsx)(t.ToggleControl,{label:(0,i.__)("最後から最初に戻る（rewind）","splide-block"),checked:O,onChange:e=>n({rewind:e})}),(0,d.jsx)(t.ToggleControl,{label:(0,i.__)("ドラッグを有効化","splide-block"),checked:N,onChange:e=>n({drag:e})}),(0,d.jsx)(t.ToggleControl,{label:(0,i.__)("キーボード操作を有効化","splide-block"),checked:F,onChange:e=>n({keyboard:e})})]})]}),(0,d.jsxs)("div",{className:"splide-block-editor",children:[(0,d.jsx)(a.MediaUploadCheck,{children:(0,d.jsx)(a.MediaUpload,{onSelect:e=>{n({images:e.map(e=>({id:e.id,url:e.url,alt:e.alt||"",caption:e.caption||""}))})},allowedTypes:["image"],multiple:!0,gallery:!0,value:p.map(e=>e.id),render:({open:e})=>(0,d.jsx)(t.Button,{onClick:e,variant:"primary",className:"splide-block-upload-button",children:0===p.length?(0,i.__)("画像を選択","splide-block"):(0,i.__)("画像を変更","splide-block")})})}),p.length>0&&(0,d.jsxs)("div",{className:"splide-block-preview",children:[(0,d.jsxs)("p",{children:["選択された画像: ",p.length,"枚"]}),p.map((e,l)=>(0,d.jsxs)("div",{className:"splide-block-image-item",children:[(0,d.jsx)("img",{src:e.url,alt:e.alt}),(0,d.jsx)(t.TextControl,{label:(0,i.__)("キャプション","splide-block"),value:e.caption||"",onChange:e=>{const a=[...p];a[l]={...a[l],caption:e},n({images:a})},placeholder:"キャプションを入力（任意）"}),(0,d.jsx)(t.Button,{onClick:()=>(e=>{const l=[...p];l.splice(e,1),n({images:l})})(l),isDestructive:!0,isSmall:!0,children:"削除"})]},l))]})]})]})},save:e=>{const{attributes:l}=e,{images:a,autoplay:t,interval:i,type:o,perPage:n,mediaQuery:s,perPageTablet:p,perPageMobile:r,breakpointTablet:h,breakpointMobile:b,height:g,heightRatio:c,heightRatioTablet:x,heightRatioMobile:u,fixedWidth:_,fixedHeight:m,fixedWidthTablet:k,fixedHeightTablet:C,fixedWidthMobile:j,fixedHeightMobile:v,gap:f,padding:y,arrows:T,pagination:R,speed:w,rewind:M,drag:P,keyboard:S,objectFit:H,cssMode:W}=l;if(0===a.length)return null;const B={};return"max"===s?(h>0&&(B[h]={perPage:p},x>0&&(B[h].heightRatio=x),k&&(B[h].fixedWidth=k),C&&(B[h].fixedHeight=C)),b>0&&(B[b]={perPage:r},u>0&&(B[b].heightRatio=u),j&&(B[b].fixedWidth=j),v&&(B[b].fixedHeight=v))):(b>0&&(B[b]={perPage:p},x>0&&(B[b].heightRatio=x),k&&(B[b].fixedWidth=k),C&&(B[b].fixedHeight=C)),h>0&&(B[h]={perPage:n},c>0&&(B[h].heightRatio=c),_&&(B[h].fixedWidth=_),m&&(B[h].fixedHeight=m))),(0,d.jsx)("div",{className:"splide","data-type":o,"data-autoplay":t,"data-interval":i,"data-perpage":"max"===s?n:r,"data-mediaquery":s,"data-gap":f,"data-padding":y,"data-arrows":T,"data-pagination":R,"data-speed":w,"data-rewind":M,"data-drag":P,"data-keyboard":S,"data-height":g,"data-heightratio":"max"===s?c>0?c:"":u>0?u:"","data-fixedwidth":"max"===s?_:j,"data-fixedheight":"max"===s?m:v,"data-objectfit":H,"data-cssmode":W,"data-breakpoints":Object.keys(B).length>0?JSON.stringify(B):"",children:(0,d.jsx)("div",{className:"splide__track",children:(0,d.jsx)("ul",{className:"splide__list",children:a.map((e,l)=>(0,d.jsxs)("li",{className:"splide__slide",children:[(0,d.jsx)("img",{src:e.url,alt:e.alt}),e.caption&&(0,d.jsx)("div",{className:"splide__slide-caption",children:e.caption})]},l))})})})}})})();